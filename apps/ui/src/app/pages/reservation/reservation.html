@if (!!reservations) {
  <div class="d-flex flex-column p-4 m-4">
    <div class="d-flex justify-content-between align-items-center w-100 mb-3">
      <h1 class="m-0">Réservations</h1>
      <button class="btn btn-primary" (click)="onCreate()">
        + Créer
      </button>
    </div>

    <form class="card p-3 mb-4" (ngSubmit)="onFilter()">
      <div class="row align-items-end g-3">

        <div class="col-md-3">
          <label for="fromDate" class="form-label">Date de début</label>
          <input
            id="fromDate"
            class="form-control"
            type="datetime-local"
            [(ngModel)]="searchForm.fromDate"
            name="fromDate"
          />
        </div>

        <div class="col-md-3">
          <label for="toDate" class="form-label">Date de fin</label>
          <input
            id="toDate"
            class="form-control"
            type="datetime-local"
            [(ngModel)]="searchForm.toDate"
            name="toDate"
          />
        </div>

        <div class="col-md-3" *ngIf="isAdmin">
          <label for="userId" class="form-label">Utilisateur</label>
          <ng-select
            [items]="owners"
            bindLabel="fullName"
            bindValue="id"
            [(ngModel)]="searchForm.userId"
            name="userId"
            [searchable]="true"
            [clearable]="true"
            [placeholder]="searchForm.userId ? '' : '-- Aucun --'"
            class="form-control"
            (clear)="onUserIdClear()"
            (ngModelChange)="onUserIdChange($event)"
          >
            <ng-template ngLabelTemplate let-owner="item">
              {{ owner.firstName }} {{ owner.lastName }}
            </ng-template>
            <ng-template ngOptionTemplate let-owner="item">
              {{ owner.firstName }} {{ owner.lastName }}
            </ng-template>
          </ng-select>
        </div>

        <div class="col-md-3">
          <label for="paymentStatus" class="form-label">Paiement</label>
          <ng-select
            [items]="paymentStatusOptions"
            bindLabel="label"
            bindValue="value"
            (clear)="onPaymentStatusClear()"
            [(ngModel)]="searchForm.paymentStatus"
            name="paymentStatus"
            [searchable]="false"
            [clearable]="true"
            [placeholder]="searchForm.paymentStatus ? '' : '-- Tous --'"
            class="form-control"
          >
            <ng-template ngOptionTemplate let-status="item">
              <i>{{ status.label }}</i>
            </ng-template>
            <ng-template ngLabelTemplate let-status="item">
              <i>{{ status.label }}</i>
            </ng-template>
          </ng-select>
        </div>
      </div>

      <button type="submit" class="btn btn-primary mt-3">Rechercher</button>
    </form>


    <div class="card me-2">
      <div class="card-body d-flex flex-column align-items-center">
        <app-table [data]="reservations">
          <ng-template column="Animal" let-data>
            <a [routerLink]="['/animal', data.animal.id]">{{ data.animal.name }}</a>
          </ng-template>
          <ng-template column="Propriétaire" let-data>
            <a
              [routerLink]="['/user', data.animal.owner.id]">{{ data.animal.owner.firstName }} {{ data.animal.owner.lastName }}</a><br>
            {{ data.animal.owner.phoneNumber }} <br>
            {{ data.animal.owner.email }}
          </ng-template>
          <ng-template column="Type de prestation" let-data>
            {{ data.serviceType.name }}
          </ng-template>
          <ng-template column="Etat réservation - paiement " let-data>
            {{ data.status | statusTranslate }}<br>
            <i> {{ data.paymentStatus | paymentTranslate }}</i>
          </ng-template>
          <ng-template column="Période" let-data>
            {{ data.startDate | date:'dd/MM/yyyy HH:mm' }} - {{ data.endDate | date:'dd/MM/yyyy HH:mm' }}
          </ng-template>
          <ng-template column="Détails" let-data>
            <a [routerLink]="['/reservation', data.id]"> <i class="fa fa-eye"></i></a>
          </ng-template>
        </app-table>
      </div>
    </div>
  </div>
}
